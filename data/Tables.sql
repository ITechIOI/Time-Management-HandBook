CREATE DATABASE TIME_MANAGEMENT_HANDBOOK

GO

USE TIME_MANAGEMENT_HANDBOOK

CREATE TABLE _USER(
	USERID VARCHAR(20) PRIMARY KEY,
	FULLNAME NVARCHAR(50),
	EMAIL VARCHAR(50),
	IS_DELETED BIT DEFAULT 0 --1: ĐÃ XÓA, 0: TỔN TẠI
)

CREATE TABLE EVENT(
	EVENT_ID VARCHAR(20) PRIMARY KEY,
	USERID VARCHAR(20),
	NAME NVARCHAR(100),
	_DATE SMALLDATETIME,
	CATEGORY VARCHAR(50),
	START_TIME TIME,
	END_TIME TIME,
	REPEAT NUMERIC(2,1), --TÍNH THƯỜNG XUYÊN 1: DAILY, 2: WEEKLY, 3: MONTHLY, 4: ANUALLY
	DESCRIPTION NVARCHAR(200),
	IS_DELETED BIT DEFAULT 0 --1: ĐÃ XÓA, 0: TỔN TẠI 
)


CREATE TABLE TASK(
	TASK_ID VARCHAR(20) PRIMARY KEY,
	USERID VARCHAR(20),
	NAME NVARCHAR(100),
	BEGIN_DATE DATETIME DEFAULT GETDATE(),
	END_DATE DATETIME,
	SUBJECT NVARCHAR(100),
	DESCRIPTION NVARCHAR(200),
	DATE_FINISHED DATETIME,
	IS_DELETED BIT DEFAULT 0 --1: ĐÃ XÓA, 0: TỒN TẠI
)

CREATE TABLE NOTI_EVENT(
	EVENT_ID VARCHAR(20),
	NOTI_ID VARCHAR(10),
	NOTIFICATE TIME,
	CONSTRAINT PK_EVENT_NOTI PRIMARY KEY (EVENT_ID,NOTI_ID)
)

CREATE TABLE NOTI_TASK(
	TASK_ID VARCHAR(20),
	NOTI_ID VARCHAR(10),
	NOTIFICATE TIME
	CONSTRAINT PK_TASK_NOTI PRIMARY KEY (TASK_ID,NOTI_ID)
)

GO

-- ADD FOREIGN KEY CONSTRAINT

ALTER TABLE NOTI_EVENT ADD
CONSTRAINT FK_EVENT_NOTI FOREIGN KEY (EVENT_ID) REFERENCES EVENT(EVENT_ID)

ALTER TABLE NOTI_TASK ADD
CONSTRAINT FK_TASK_NOTI FOREIGN KEY (TASK_ID) REFERENCES TASK(TASK_ID)

ALTER TABLE EVENT ADD
CONSTRAINT FK_USER_EVE FOREIGN KEY (USERID) REFERENCES _USER(USERID)

ALTER TABLE TASK ADD
CONSTRAINT FK_USER_TASK FOREIGN KEY (USERID) REFERENCES _USER(USERID)

